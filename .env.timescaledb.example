# ============================================
# LogiX TimescaleDB 环境变量配置示例
# LogiX TimescaleDB Environment Variables Example
# ============================================

# ============================================
# 应用配置
# ============================================
NODE_ENV=production
PORT=3001
API_PREFIX=/api/v1

# ============================================
# TimescaleDB 数据库配置
# ============================================
DB_USERNAME=logix_user
DB_PASSWORD=your_strong_password_here_change_this_in_production
DB_DATABASE=logix_db
DB_PORT=5432

# TimescaleDB 性能调优
# Memory: 建议设置为系统内存的 25%
PG_MEMORY=4GB
# CPUs: 数据库使用的 CPU 核心数
PG_CPUS=4
# 最大连接数
PG_MAX_CONNECTIONS=100
# 共享缓冲区
PG_SHARED_BUFFERS=1GB
# 有效缓存大小
PG_EFFECTIVE_CACHE=3GB
# 维护工作内存
PG_MAINTENANCE_WORK_MEM=256MB
# 最大工作进程
PG_MAX_WORKERS=8
# 并行工作进程
PG_PARALLEL_WORKERS=4
# 工作内存
PG_WORK_MEM=4MB

# 连接池配置
DB_POOL_MIN=5
DB_POOL_MAX=20

# ============================================
# Redis 缓存配置
# ============================================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=your_redis_password_here
REDIS_DB=0

# ============================================
# Elasticsearch 配置
# ============================================
ES_NODE=http://elasticsearch:9200
ES_PORT=9200
ES_USERNAME=
ES_PASSWORD=
ES_SECURITY_ENABLED=false
ES_HEAP_SIZE=1g

# ============================================
# 飞驼 API 配置
# ============================================
FEITUO_API_ENDPOINT=https://api.feituo.com/v1
FEITUO_API_KEY=your_feituo_api_key_here

# ============================================
# 日志配置
# ============================================
LOG_LEVEL=info
LOG_FILE_PATH=/app/logs

# ============================================
# CORS 配置
# ============================================
CORS_ORIGIN=https://your-frontend-domain.com

# ============================================
# Socket.IO 配置
# ============================================
SOCKET_CORS_ORIGIN=https://your-frontend-domain.com

# ============================================
# 速率限制配置
# ============================================
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# ============================================
# 健康检查配置
# ============================================
HEALTH_CHECK_INTERVAL=60000

# ============================================
# 微服务配置
# ============================================
LOGISTICS_PATH_SERVICE_URL=http://logistics-path-service:4000
LOGISTICS_PATH_SERVICE_TOKEN=your_token_here

# ============================================
# 适配器配置
# ============================================
DEFAULT_ADAPTER_SOURCE=logistics_path
ADAPTER_HEALTH_CHECK_INTERVAL=60000
ADAPTER_ENABLE_AUTO_FAILOVER=true

# ============================================
# Grafana 配置
# ============================================
GRAFANA_PORT=3000
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=your_grafana_password_here
GRAFANA_ROOT_URL=/

# ============================================
# TimescaleDB 数据保留策略
# TimescaleDB Data Retention Policies
# ============================================

# 容器状态事件保留天数
CONTAINER_STATUS_RETENTION_DAYS=730

# 港口操作保留天数
PORT_OPERATION_RETENTION_DAYS=1095

# 数据压缩策略
# 容器状态事件压缩天数（30天前的数据开始压缩）
CONTAINER_STATUS_COMPRESSION_DAYS=30
# 港口操作压缩天数（90天前的数据开始压缩）
PORT_OPERATION_COMPRESSION_DAYS=90

# 连续聚合视图刷新间隔
# 每日统计刷新间隔（小时）
DAILY_STATS_REFRESH_INTERVAL_HOURS=1
# 每周统计刷新间隔（小时）
WEEKLY_STATS_REFRESH_INTERVAL_HOURS=24

# ============================================
# 监控和告警配置
# Monitoring and Alerting Configuration
# ============================================

# Prometheus 配置
PROMETHEUS_RETENTION_DAYS=30

# 告警阈值
# 数据库连接数告警
DB_CONNECTIONS_ALERT_THRESHOLD=80
# 查询慢查询告警（毫秒）
SLOW_QUERY_ALERT_THRESHOLD_MS=1000
# 数据压缩失败告警
COMPRESSION_FAILURE_ALERT_THRESHOLD=3

# ============================================
# 备份配置
# Backup Configuration
# ============================================

# 自动备份间隔（小时）
BACKUP_INTERVAL_HOURS=24
# 备份保留天数
BACKUP_RETENTION_DAYS=30
# 备份存储路径
BACKUP_PATH=/backups

# ============================================
# 安全配置
# Security Configuration
# ============================================

# SSL/TLS 配置
SSL_ENABLED=true
SSL_CERT_PATH=/etc/nginx/ssl/cert.pem
SSL_KEY_PATH=/etc/nginx/ssl/key.pem

# JWT 配置
JWT_SECRET=your_jwt_secret_here_change_this
JWT_EXPIRE_TIME=24h

# ============================================
# 开发环境特殊配置
# Development Environment Special Configuration
# ============================================

# 取消注释以下配置用于开发环境
# Uncomment the following for development environment

# NODE_ENV=development
# LOG_LEVEL=debug
# DB_USERNAME=postgres
# DB_PASSWORD=postgres
# REDIS_PASSWORD=
# ES_SECURITY_ENABLED=false
# GRAFANA_ADMIN_PASSWORD=admin

# ============================================
# 注意事项
# Notes
# ============================================

# 1. 生产环境中必须修改所有默认密码
# 1. Change all default passwords in production

# 2. 根据服务器资源调整内存和 CPU 配置
# 2. Adjust memory and CPU settings based on server resources

# 3. 根据业务需求调整数据保留策略
# 3. Adjust data retention policies based on business needs

# 4. 定期备份数据库
# 4. Backup database regularly

# 5. 监控数据库性能指标
# 5. Monitor database performance metrics
